<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Weather App</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            overflow: hidden; /* Hide scrollbars for the full-screen canvas */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1a26; /* Fallback background color */
            position: relative;
        }
        #background-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            transition: background-color 0.5s ease-in-out;
        }
        .weather-card-container {
            position: relative;
            z-index: 10;
        }
        .weather-card {
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            transition: background 0.5s ease-in-out;
        }
        .loader {
            border-top-color: #3498db;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Icon animation */
        @keyframes bounce-slow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .icon-bounce {
            animation: bounce-slow 4s infinite ease-in-out;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen text-gray-100">

    <!-- Canvas for the animated background -->
    <canvas id="background-canvas"></canvas>

    <!-- Main Container -->
    <div class="weather-card-container p-4 md:p-8 w-11/12 max-w-2xl mx-auto my-auto">
        <div id="weather-card" class="weather-card p-6 md:p-10 rounded-3xl text-center flex flex-col items-center border border-white border-opacity-40">
            <h1 class="text-3xl md:text-4xl font-bold mb-4 text-white drop-shadow-lg">The Weather Application</h1>
            <p class="text-sm md:text-base mb-6 text-white text-opacity-80 drop-shadow-md">Get real-time weather information in any place.</p>

            <!-- Search Form -->
            <form id="weather-form" class="w-full flex flex-col md:flex-row items-center gap-4">
                <input type="text" id="location-input" placeholder="Enter a city name..." class="flex-1 w-full md:w-auto p-3 rounded-xl bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-70 border border-white border-opacity-50 focus:border-blue-500 focus:outline-none transition-colors shadow-inner">
                <button type="submit" class="w-full md:w-auto p-3 rounded-xl bg-white bg-opacity-30 hover:bg-opacity-40 text-blue-900 font-semibold transition-colors duration-300 transform active:scale-95 shadow-md">
                    Search
                </button>
            </form>

            <!-- Weather Display Area -->
            <div id="weather-results" class="mt-8 w-full">
                <div id="loading" class="hidden">
                    <div class="loader w-10 h-10 rounded-full border-4 border-white border-t-blue-500 mx-auto"></div>
                    <p class="mt-2 text-sm text-white text-opacity-70">Fetching weather...</p>
                </div>
                
                <div id="weather-info" class="hidden fade-in">
                    <!-- Data will be dynamically inserted here -->
                </div>

                <div id="error-message" class="hidden text-red-300 mt-4 text-sm font-semibold">
                    <!-- Error messages will be displayed here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="text-center text-sm text-white text-opacity-50 p-4 absolute bottom-0 w-full z-20">
        &copy; <span id="year"></span> Christian Brioso | Weather App. All rights reserved.
    </footer>

    <!-- JavaScript for fetching data and updating the UI -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('weather-form');
            const locationInput = document.getElementById('location-input');
            const loadingIndicator = document.getElementById('loading');
            const weatherInfoDiv = document.getElementById('weather-info');
            const errorMessageDiv = document.getElementById('error-message');
            const weatherCard = document.getElementById('weather-card');

            const API_KEY = '2b281f39157c4771919141654250409';
            let particles = [];
            let canvas, ctx;

            // Initialize canvas and particles
            function initCanvas() {
                canvas = document.getElementById('background-canvas');
                ctx = canvas.getContext('2d');
                resizeCanvas();
                window.addEventListener('resize', resizeCanvas);
                createParticles();
                animateParticles();
            }

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }

            // Define a Particle class
            class Particle {
                constructor(x, y, color) {
                    this.x = x;
                    this.y = y;
                    this.radius = Math.random() * 2 + 1;
                    this.color = color;
                    this.velocity = {
                        x: (Math.random() - 0.5) * 0.5,
                        y: (Math.random() - 0.5) * 0.5
                    };
                }

                draw() {
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);
                    ctx.fillStyle = this.color;
                    ctx.fill();
                    ctx.closePath();
                }

                update() {
                    this.x += this.velocity.x;
                    this.y += this.velocity.y;

                    // Reverse direction if hitting boundaries
                    if (this.x + this.radius > canvas.width || this.x - this.radius < 0) {
                        this.velocity.x = -this.velocity.x;
                    }
                    if (this.y + this.radius > canvas.height || this.y - this.radius < 0) {
                        this.velocity.y = -this.velocity.y;
                    }

                    this.draw();
                }
            }

            function createParticles() {
                particles = [];
                const numParticles = Math.floor((canvas.width * canvas.height) / 10000);
                for (let i = 0; i < numParticles; i++) {
                    const x = Math.random() * canvas.width;
                    const y = Math.random() * canvas.height;
                    particles.push(new Particle(x, y, '#ffffff')); // Default color
                }
            }

            function animateParticles() {
                requestAnimationFrame(animateParticles);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(particle => {
                    particle.update();
                });
            }

            function updateParticleColors(temp, conditionText, windKph) {
                let colors;
                const condition = conditionText.toLowerCase();

                // Priority 1: Rain/Snow/Clouds
                if (condition.includes('rain') || condition.includes('drizzle') || condition.includes('sleet') || condition.includes('freezing')) {
                    colors = ['#4A76A8', '#6495ED', '#87CEEB']; // Rainy Blues
                } else if (condition.includes('snow') || condition.includes('ice') || condition.includes('blizzard')) {
                    colors = ['#B0E0E6', '#ADD8E6', '#F0F8FF']; // Snowy blues
                } else if (condition.includes('cloudy') || condition.includes('overcast') || condition.includes('fog') || condition.includes('mist')) {
                    colors = ['#9A9DAB', '#B4B6C1', '#C5C6D1']; // Cloudy grays
                }
                // Priority 2: High Wind
                else if (windKph > 30) {
                    colors = ['#B0B5C1', '#D3D8E1', '#E8EBF0']; // Windy grays
                }
                // Priority 3: Temperature
                else if (temp < 0) {
                    colors = ['#87CEFA', '#ADD8E6', '#B0E0E6']; // Cold
                } else if (temp >= 0 && temp < 15) {
                    colors = ['#A8E0F0', '#90B0FF', '#B0A8F0']; // Cool
                } else if (temp >= 15 && temp < 25) {
                    colors = ['#A8F0A8', '#90EE90', '#3CB371']; // Mild
                } else if (temp >= 25 && temp < 35) {
                    colors = ['#FFDAB9', '#FFA07A', '#FF7F50']; // Warm
                } else {
                    colors = ['#FF4500', '#FF6347', '#FF8C00']; // Hot
                }

                particles.forEach(particle => {
                    particle.color = colors[Math.floor(Math.random() * colors.length)];
                });
            }

            // Event Listeners and Functions
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const location = locationInput.value.trim();

                if (!location) {
                    displayError('Please enter a city name.');
                    return;
                }

                if (API_KEY === 'YOUR_API_KEY' || API_KEY.length < 10) {
                    displayError('Error: Please replace "YOUR_API_KEY" with your actual API key from WeatherAPI.com.');
                    return;
                }

                loadingIndicator.classList.remove('hidden');
                weatherInfoDiv.classList.add('hidden');
                errorMessageDiv.classList.add('hidden');

                try {
                    const response = await fetch(`https://api.weatherapi.com/v1/current.json?key=${API_KEY}&q=${location}`);
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error.message || `Error: ${response.status} - ${response.statusText}`);
                    }

                    const data = await response.json();
                    displayWeather(data);

                } catch (error) {
                    displayError(error.message);
                } finally {
                    loadingIndicator.classList.add('hidden');
                }
            });

            function getWeatherStyles(temp, conditionText, windKph) {
                const condition = conditionText.toLowerCase();

                // Priority 1: Rain/Snow/Clouds
                if (condition.includes('rain') || condition.includes('drizzle') || condition.includes('sleet') || condition.includes('freezing')) {
                    return {
                        textColor: 'text-blue-900',
                        tempColor: 'text-blue-900',
                        feelsLikeColor: 'text-blue-800',
                        iconColor: 'filter: drop-shadow(0 0 5px #bfdbfe);',
                        cardGradient: 'bg-gradient-to-br from-blue-400 to-indigo-600',
                    };
                } else if (condition.includes('snow') || condition.includes('ice') || condition.includes('blizzard')) {
                    return {
                        textColor: 'text-cyan-900',
                        tempColor: 'text-cyan-900',
                        feelsLikeColor: 'text-cyan-800',
                        iconColor: 'filter: drop-shadow(0 0 5px #B0E0E6);',
                        cardGradient: 'bg-gradient-to-br from-cyan-200 to-blue-400',
                    };
                } else if (condition.includes('cloudy') || condition.includes('overcast') || condition.includes('fog') || condition.includes('mist')) {
                    return {
                        textColor: 'text-gray-900',
                        tempColor: 'text-gray-900',
                        feelsLikeColor: 'text-gray-800',
                        iconColor: 'filter: drop-shadow(0 0 5px #9A9DAB);',
                        cardGradient: 'bg-gradient-to-br from-gray-400 to-gray-500',
                    };
                }
                // Priority 2: High Wind
                else if (windKph > 30) {
                    return {
                        textColor: 'text-gray-800',
                        tempColor: 'text-gray-900',
                        feelsLikeColor: 'text-gray-700',
                        iconColor: 'filter: drop-shadow(0 0 5px #B0B5C1);',
                        cardGradient: 'bg-gradient-to-br from-gray-300 to-slate-400',
                    };
                }
                // Priority 3: Temperature-based fallback
                else {
                    if (temp < 0) {
                        return { textColor: 'text-blue-900', tempColor: 'text-blue-900', feelsLikeColor: 'text-blue-800', iconColor: 'filter: drop-shadow(0 0 5px #bfdbfe);', cardGradient: 'bg-gradient-to-br from-blue-600 to-cyan-400' };
                    } else if (temp >= 0 && temp < 10) {
                        return { textColor: 'text-indigo-900', tempColor: 'text-indigo-900', feelsLikeColor: 'text-indigo-800', iconColor: 'filter: drop-shadow(0 0 5px #c7d2fe);', cardGradient: 'bg-gradient-to-br from-indigo-500 to-sky-400' };
                    } else if (temp >= 10 && temp < 20) {
                        return { textColor: 'text-emerald-900', tempColor: 'text-emerald-900', feelsLikeColor: 'text-emerald-800', iconColor: 'filter: drop-shadow(0 0 5px #6ee7b7);', cardGradient: 'bg-gradient-to-br from-green-500 to-lime-400' };
                    } else if (temp >= 20 && temp < 30) {
                        return { textColor: 'text-amber-900', tempColor: 'text-amber-900', feelsLikeColor: 'text-amber-800', iconColor: 'filter: drop-shadow(0 0 5px #fde68a);', cardGradient: 'bg-gradient-to-br from-yellow-500 to-orange-400' };
                    } else if (temp >= 30 && temp < 40) {
                        return { textColor: 'text-red-900', tempColor: 'text-red-900', feelsLikeColor: 'text-red-800', iconColor: 'filter: drop-shadow(0 0 5px #fca5a5);', cardGradient: 'bg-gradient-to-br from-orange-500 to-red-500' };
                    } else {
                        return { textColor: 'text-red-900', tempColor: 'text-red-900', feelsLikeColor: 'text-red-800', iconColor: 'filter: drop-shadow(0 0 5px #fca5a5);', cardGradient: 'bg-gradient-to-br from-red-600 to-pink-500' };
                    }
                }
            }

            function displayWeather(data) {
                const { name, country } = data.location;
                const { temp_c, feelslike_c, wind_kph, humidity, condition, uv } = data.current;
                
                const weatherText = condition.text;
                const temperature = Math.round(temp_c);
                const feelsLikeTemp = Math.round(feelslike_c);
                const windSpeed = Math.round(wind_kph);
                const humidityVal = humidity;
                const uvIndex = uv;
                const iconUrl = `https:${condition.icon}`;

                const { textColor, tempColor, iconColor, feelsLikeColor, cardGradient } = getWeatherStyles(temperature, weatherText, windSpeed);

                weatherInfoDiv.innerHTML = `
                    <div class="flex flex-col items-center justify-center gap-4 mb-4">
                        <img src="${iconUrl}" alt="${weatherText}" class="w-20 h-20 md:w-24 md:h-24 drop-shadow-lg icon-bounce" style="${iconColor}">
                        <div class="text-left md:text-center">
                            <h2 class="text-5xl md:text-6xl font-extrabold ${tempColor} drop-shadow-md">${temperature}°C</h2>
                            <p class="mt-1 text-2xl md:text-3xl capitalize ${textColor} drop-shadow-md">${weatherText}</p>
                        </div>
                    </div>
                    <h3 class="text-2xl md:text-3xl font-bold mb-4 ${textColor} drop-shadow-md">${name}, ${country}</h3>
                    <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm md:text-base text-center">
                        <div class="p-3 bg-white bg-opacity-10 rounded-xl">
                            <p class="font-semibold text-gray-200">Feels Like</p>
                            <p class="font-bold ${feelsLikeColor}">${feelsLikeTemp}°C</p>
                        </div>
                        <div class="p-3 bg-white bg-opacity-10 rounded-xl">
                            <p class="font-semibold text-gray-200">Humidity</p>
                            <p class="font-bold ${textColor}">${humidityVal}%</p>
                        </div>
                        <div class="p-3 bg-white bg-opacity-10 rounded-xl">
                            <p class="font-semibold text-gray-200">Wind</p>
                            <p class="font-bold ${textColor}">${windSpeed} km/h</p>
                        </div>
                        <div class="p-3 bg-white bg-opacity-10 rounded-xl">
                            <p class="font-semibold text-gray-200">UV Index</p>
                            <p class="font-bold ${textColor}">${uvIndex}</p>
                        </div>
                    </div>
                `;
                weatherInfoDiv.classList.remove('hidden');
                updateParticleColors(temperature, weatherText, windSpeed);
                updateCardColor(cardGradient);
            }

            function displayError(message) {
                errorMessageDiv.textContent = message;
                errorMessageDiv.classList.remove('hidden');
            }
            
            function updateCardColor(gradientClass) {
                weatherCard.className = `weather-card p-6 md:p-10 rounded-3xl text-center flex flex-col items-center border border-white border-opacity-40 ${gradientClass}`;
            }

            // Start the canvas animation when the DOM is ready
            initCanvas();
        });

document.getElementById("year").innerHTML = new Date().getFullYear();
        
    </script>
</body>
</html>
